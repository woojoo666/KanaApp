<!DOCTYPE HTML>
<html lang="en" manifest="index.manifest">

<head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=0.5, maximum-scale=0.5, user-scalable=0" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <link rel="apple-touch-icon" sizes="57x57" href="icons/wu-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="icons/wu-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="icons/wu-114x114.png" />
    <link rel="icon" type="image/png" href="icons/favicon.png" />

    <title>Hiragana Draw</title>
    <style id="sty">
    @font-face {
        font-family: Kozuko;
        src: url(KFhimaji.otf);
    }
    body {
        font-family: Kozuko;
        overflow:hidden;
    }
    .right {
        float:right
    }
    .page {
        width: 600px;
        height: 920px;
        position: absolute;
        left:20px;
        top:0;
        z-index: 1;
    }
    .background {
        position:absolute;
        left:0px;
        top:0px;
        z-index: -1;
    }
    #menupage {
        width: 640px;
        height: 920px;
        text-align:center;
        font-size:90px;
        color: white;
        left:0px;
        margin-top: 0px;
        margin-bottom: 50px;
    }
    #testpage {
        font-size:60px;
        color:white;
    }
    #settingspage {
        width: 620px;
        text-align:center;
        font-size:60px;
        color:white;
        overflow:hidden;
    }
    #resultspage {
        text-align:center;
        font-size:30px;
        color:white;
    }
    #maintitle {
        width:640px;
        position: absolute;
        left:0;
        top:220px;
        z-index:2;
        -webkit-opacity: 1;
        -moz-opacity: 1;
        opacity: 1;
        -webkit-transition: all 1s ease;
        -moz-transition: all 1s ease;
        -ms-transition: all 1s ease;
        -o-transition: all 1s ease;
        transition: all 1s ease;
    }
    #overlay {
        background: url('Images/Background Scroll - bordered.png');
        z-index: 2;
        text-align:center;
        left:0;
        right:0;
        width:100%;
        height:100%
    }
    #loading {
        margin-top:700px;
        z-index:1
    }
    #backbutton {
        width:100px;
        position:absolute;
        left:10px;
        top:10px;
        z-index:2;
        display:none
    }
    #containr {
        border: 3px solid white;
        overflow:scroll;
        height:700px;
    }
    .back {
        position:absolute;
        left:1px;
        top:1px;
        z-index:1;
        font-size:60px
    }
    .title {
        font-size:140px;
        margin-top:0;
        position:absolute;
        top:-10px;
    }
    .titlehead {
        background: url('Images/Header2.png');
        position:relative;
        height: 168px;
        width:640px;
        left:-20px;
        top:0;
        z-index: 0;
        overflow:hidden;
    }
    #canvasDiv {
        position:relative;
    }
    #playbutton {
        width: 75px;
        position:absolute;
        right: 40px;
        top: 20px;
        z-index:2
    }
    #playbuttonbackground {
        position:absolute;
        left:292px;
        z-index:1;
        pointer-events:none
    }
    #canvas {
        background-color: rgba(255, 255, 255, 0.5);
        z-index:0
    }
    #selector {
        font-size:40px;
        color:#999;
    }
    #listtable {
        font-size:40px;
    }
    .listtablecell {
        width: 500px;
    }
    .leftspan {
        float: left;
        text-align:left;
    }
    .onoffbutton {
        background: url('Images/onoffbutton.png');
        float: right;
        width: 20px;
    }
    </style>
</head>

<body onload="init();">
    <div id="overlay" class="page">

        <img id="loading" src="Images/Loading.png">
    </div>

    <img id="maintitle" src="Images/Title Overlay.png">
    <img src="Images/Background Scroll - bordered.png" class="background">

    <div id="menupage" class="page">
        <div style="height:400px;"></div>
        <p onclick="jumpTo('testpage')" style="margin-top: 0px;margin-bottom: 50px;">Start Test</p>
        <p onclick="jumpTo('resultspage')" style="margin-top: 0px;margin-bottom: 50px;">Results</p>
        <p onclick="jumpTo('settingspage')" style="margin-top: 0px;margin-bottom: 50px;">Settings</p>
    </div>

    <img id="backbutton" src="Images/Back Button.png" onclick="jumpTo('menupage');">

    <div id="testpage" class="page">
        <div class="titlehead">
            <p style="left:130px" class="title">Test!</p>
        </div>
        <div style="position:relative;">
            <span class="right">
                <select id="selector" style="font-family: Kozuko"></select>
                <span onclick="go()">Go</span>
            </span>
        </div>
        <br>
        <audio id="player">Your browser does not support audio tag</audio>
        <div id="canvasDiv">
            <img id="playbutton" src='Images/Playbutton On.png' onclick="play();">
            <img id="playbuttonbackground" src='Images/Playbutton Back.png'>
            <canvas id="canvas" height="600"></canvas>
        </div>

        <br>
    </div>

    <div id="resultspage" class="page">
        <div class="titlehead">
            <p style="left: 130px;" class="title">Results</p>
        </div>
        <div style="height:10px"></div>
        <span onclick="showAllCharacters();">Characters /</span>
        <span onclick="showAllPercents();">Percentages</span>
        <div id="containr">
            <table id="results"></table>
            <table id="listtable"></table>
        </div>
    </div>

    <div id='settingspage' class="page">
        <div class="titlehead">
            <p style="left: 90px;" class="title">Settings</p>
        </div>
        <div style="height:100px"></div>
        <input id="volumeslider" type="range" min="0" max="100" step="1" onchange="setVolume()">Volume</input>
        <p onclick="clearAll()">Clear All Data</p>
    </div>

    <script>
    window.onorientationchange = function() {
        reorient();
    }

    //finds the center of a 90 degree rotation based on the current and projected coordinates of a point, and if the rotation is clockwise or not

    function findCenter(curr, next, clockwise) {
        midLenX = (next[0] - curr[0]) / 2;
        midLenY = (next[1] - curr[1]) / 2;
        centerX = curr[0] + midLenX + ((clockwise) ? -midLenY : midLenY);
        centerY = curr[1] + midLenY + ((clockwise) ? midLenX : -midLenX);
        return [centerX, centerY];
    }

    function reorient() {
        if (window.orientation % 180 == 0) { //portrait mode, reset rotation
            document.body.style.webkitTransform = "";
        } else if (window.orientation == -90) { //clockwise rotation
            var center = findCenter([0, 0], [960, 0], true);
            document.body.style.webkitTransformOrigin = center[0] + "px " + (center[1] - 10) + "px";
            document.body.style.webkitTransform = 'rotate(90deg)';
        } else { //counterclockwise rotation
            var center = findCenter([0, 0], [0, 640], false);
            document.body.style.webkitTransformOrigin = (center[0] - 30) + "px " + (center[1] - 20) + "px";
            document.body.style.webkitTransform = 'rotate(-90deg)';
        }
    }

    function init() {
        reorient();
        initTest();
        initTable();
        $('overlay').onclick = function() {
            jumpTo('menupage');
            startup()
        };
        $('loading').src = "Images/Continue.png"
        jumpTo('overlay');
    }

    function startup() {
        document.body.removeChild($('overlay'));
        var maintitle = document.body.removeChild($('maintitle'));
        $('menupage').appendChild(maintitle);
        //          maintitle.style.opacity = 0;
        window.setTimeout(function() {
            maintitle.style.top = '-50px';
        }, 100);
    }

    function jumpTo(page) {
        var pages = document.body.childNodes;
        for (var i = 0; i < pages.length; i++) {
            if (pages[i].className == "page") {
                pages[i].style.display = "none";
            }
        }
        document.getElementById(page).style.display = "block";
        if (page == "resultspage") {
            refresh();
        }
        $('backbutton').style.display = (page == 'menupage' || page == 'overlay') ? "none" : "block";
    }

    function setVolume() {
        document.getElementById('player').volume = document.getElementById('volumeslider').value / 100;
    }
    </script>
    <script src="maindiv.js"></script>
    <script src="resultsdiv.js"></script>
</body>

</html>
